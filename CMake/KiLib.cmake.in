### KiLib Install Process

set(EXTERNAL_INSTALL_LOCATION ${CMAKE_BINARY_DIR}/external)

if(WIN32)
  set(BYPRODUCT_SPDLOG ${EXTERNAL_INSTALL_LOCATION}/lib/spdlog.lib)
  set(BYPRODUCT_YAMLCPP ${EXTERNAL_INSTALL_LOCATION}/lib/libyaml-cppmd.lib)
  set(BYPRODUCT_KILIB ${EXTERNAL_INSTALL_LOCATION}/lib/KiLib.lib)
endif(WIN32)

if(UNIX)
  set(BYPRODUCT_SPDLOG ${EXTERNAL_INSTALL_LOCATION}/lib/libspdlog.a)
  set(BYPRODUCT_YAMLCPP ${EXTERNAL_INSTALL_LOCATION}/lib/libyaml-cpp.a)
  set(BYPRODUCT_KILIB ${EXTERNAL_INSTALL_LOCATION}/lib/libKiLib.a)
endif(UNIX)


# KiLib
include(ExternalProject)
ExternalProject_Add(project_KiLib
  GIT_REPOSITORY git@github.com:CoSci-LLC/KiLib-OSS.git
  GIT_TAG main
  CMAKE_ARGS -DCMAKE_INSTALL_PREFIX=${EXTERNAL_INSTALL_LOCATION} -DCMAKE_PROJECT_NAME=${CMAKE_PROJECT_NAME} -DCMAKE_BUILD_TYPE:-DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE} -DCMAKE_INSTALL_INCLUDEDIR=include -DCMAKE_INTERPROCEDURAL_OPTIMIZATION=TRUE
  BUILD_BYPRODUCTS  ${BYPRODUCT_SPDLOG} ${BYPRODUCT_YAMLCPP} ${BYPRODUCT_KILIB}
)
include_directories(${EXTERNAL_INSTALL_LOCATION}/include/)
include_directories(${EXTERNAL_INSTALL_LOCATION}/include/KiLib/)
add_library(KiLib STATIC IMPORTED)
set_property(TARGET KiLib PROPERTY IMPORTED_LOCATION ${BYPRODUCT_KILIB})

# Spdlog
add_library(spdlog STATIC IMPORTED GLOBAL)
set_property(TARGET spdlog PROPERTY IMPORTED_LOCATION ${BYPRODUCT_SPDLOG})
add_dependencies(spdlog project_KiLib)

# yaml-cpp
add_library(yaml-cpp STATIC IMPORTED GLOBAL)
set_property(TARGET yaml-cpp PROPERTY IMPORTED_LOCATION ${BYPRODUCT_YAMLCPP})
add_dependencies(yaml-cpp project_KiLib)


add_dependencies(KiLib project_KiLib yaml-cpp spdlog)
target_link_libraries(KiLib INTERFACE yaml-cpp spdlog)